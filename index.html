<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è´è¶çš„ä¸€ç”Ÿ - äº’å‹•æ¨¡æ“¬</title>
    <style>
        /* --- åŸºç¤è¨­å®š --- */
        body {
            margin: 0;
            padding: 0;
            font-family: 'Noto Sans TC', 'Microsoft JhengHei', sans-serif;
            background: linear-gradient(to bottom, #87CEEB, #E0F7FA);
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden;
            user-select: none;
        }

        /* --- éŠæˆ²å®¹å™¨ --- */
        .game-container {
            position: relative;
            width: 100%;
            max-width: 600px;
            height: 500px;
            background-color: rgba(255, 255, 255, 0.8);
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            overflow: hidden;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        /* --- UI ä»‹é¢ --- */
        .ui-header {
            margin-top: 20px;
            text-align: center;
            z-index: 10;
        }

        h1 {
            margin: 0;
            color: #2c3e50;
            font-size: 1.5rem;
        }

        .stage-indicator {
            margin-top: 5px;
            font-size: 0.9rem;
            color: #555;
            background: #fff;
            padding: 5px 15px;
            border-radius: 15px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

        .instruction-box {
            position: absolute;
            bottom: 30px;
            background: white;
            padding: 15px 25px;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            text-align: center;
            width: 80%;
            z-index: 20;
            transition: all 0.3s ease;
        }

        .instruction-text {
            font-size: 1.1rem;
            color: #333;
            margin-bottom: 10px;
            line-height: 1.5;
        }

        .action-btn {
            background: #4CAF50;
            color: white;
            border: none;
            padding: 10px 24px;
            border-radius: 25px;
            font-size: 1rem;
            cursor: pointer;
            transition: transform 0.1s, background 0.2s;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        .action-btn:active {
            transform: scale(0.95);
        }

        .action-btn:hover {
            background: #45a049;
        }

        .restart-btn {
            background: #FF9800;
        }

        /* --- å ´æ™¯å…ƒç´  --- */
        .scene {
            position: absolute;
            top: 60px;
            left: 0;
            width: 100%;
            height: 300px;
            pointer-events: none; /* è®“é»æ“Šç©¿é€åˆ°æŒ‰éˆ•ï¼Œé™¤éç‰¹å®šå…ƒç´ éœ€è¦é»æ“Š */
        }

        /* æ¨¹æ */
        .branch {
            position: absolute;
            top: 20px;
            left: -50px;
            width: 300px;
            height: 10px;
            background: #8B4513;
            transform: rotate(10deg);
            border-radius: 5px;
            z-index: 1;
        }

        /* è‘‰å­ */
        .leaf {
            position: absolute;
            top: 30px;
            left: 50%;
            transform: translateX(-50%) rotate(0deg);
            width: 200px;
            height: 100px;
            background: #4CAF50;
            border-radius: 5px 100px 5px 100px;
            box-shadow: inset -10px -10px 0 rgba(0,0,0,0.1);
            transition: all 0.5s ease;
            z-index: 2;
            transform-origin: left top;
        }
        
        .leaf.eaten {
            /* æ¨¡æ“¬è¢«åƒæ‰çš„æ¨£å­ */
            clip-path: polygon(0% 0%, 100% 0%, 100% 100%, 80% 90%, 70% 100%, 50% 85%, 40% 100%, 20% 90%, 0% 100%);
            background: #388E3C;
        }

        .leaf.withered {
            background: #8D6E63;
            transform: translateX(-50%) rotate(80deg);
            opacity: 0.5;
        }

        /* --- ç”Ÿç‰© (ä½¿ç”¨ Emoji é…åˆ CSS å‹•ç•«) --- */
        .creature {
            position: absolute;
            font-size: 3rem;
            transition: all 1s ease;
            z-index: 5;
            cursor: pointer;
            pointer-events: auto; /* ç”Ÿç‰©æœ¬èº«å¯ä»¥è¢«é»æ“Š */
        }

        /* éšæ®µ 1: åµ */
        .egg {
            top: 60px;
            left: 55%;
            font-size: 1.5rem;
            filter: drop-shadow(2px 2px 2px rgba(0,0,0,0.2));
            animation: pulse 2s infinite;
        }
        .egg::after {
            content: "âšª"; /* ä½¿ç”¨ç™½è‰²åœ“å½¢ä»£è¡¨åµ */
            color: #FFFDD0;
        }

        /* éšæ®µ 2: å¹¼èŸ² */
        .caterpillar {
            top: 50px;
            left: 45%;
            font-size: 2.5rem;
        }
        .caterpillar::after {
            content: "ğŸ›";
        }
        .caterpillar.eating {
            animation: eat 0.5s infinite alternate;
        }

        /* éšæ®µ 3: è›¹ */
        .pupa {
            top: 30px; /* æ›åœ¨æ¨¹æä¸‹ */
            left: 100px;
            font-size: 3rem;
            transform-origin: top center;
        }
        /* ç”±æ–¼æ²’æœ‰å®Œç¾çš„è›¹ Emojiï¼Œæˆ‘å€‘ç”¨ CSS ç¹ªè£½ä¸€å€‹ç°¡å–®çš„ */
        .pupa-shape {
            width: 30px;
            height: 60px;
            background: #8B5A2B;
            border-radius: 50% 50% 50% 50% / 60% 60% 40% 40%;
            position: relative;
            box-shadow: inset 5px 0 5px rgba(0,0,0,0.2);
        }
        .pupa-shape::before {
            content: '';
            position: absolute;
            top: -10px;
            left: 13px;
            width: 4px;
            height: 10px;
            background: #eee; /* çµ²ç·š */
        }
        .pupa.shaking {
            animation: shake 0.5s infinite;
        }

        /* éšæ®µ 4: è´è¶ */
        .butterfly {
            top: 100px;
            left: 50%;
            font-size: 4rem;
            transition: all 2s ease;
        }
        .butterfly::after {
            content: "ğŸ¦‹";
            display: block;
            /* å±•ç¿…å‹•ç•« */
            animation: flap 0.2s infinite alternate;
        }
        .butterfly.flying {
            animation: flyAround 8s infinite linear;
        }

        /* --- å‹•ç•«é—œéµå½±æ ¼ --- */
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }

        @keyframes eat {
            0% { transform: translateX(0) scaleX(1); }
            100% { transform: translateX(5px) scaleX(0.9); }
        }

        @keyframes shake {
            0% { transform: rotate(0deg); }
            25% { transform: rotate(10deg); }
            75% { transform: rotate(-10deg); }
            100% { transform: rotate(0deg); }
        }

        @keyframes flap {
            0% { transform: scaleX(1); }
            100% { transform: scaleX(0.4); } /* æ¨¡æ“¬ç¿…è†€åˆæ” */
        }

        @keyframes flyAround {
            0% { transform: translate(0, 0) rotate(0deg); }
            25% { transform: translate(100px, -50px) rotate(15deg); }
            50% { transform: translate(0, -100px) rotate(-10deg); }
            75% { transform: translate(-100px, -30px) rotate(-15deg); }
            100% { transform: translate(0, 0) rotate(0deg); }
        }
        
        /* éš±è—å…ƒç´  */
        .hidden {
            display: none !important;
            opacity: 0;
        }

        /* èƒŒæ™¯è£é£¾ - èŠ±æœµ */
        .flower {
            position: absolute;
            bottom: 20px;
            font-size: 2rem;
            z-index: 1;
        }

    </style>
</head>
<body>

    <div class="game-container">
        <!-- æ¨™é¡Œå€ -->
        <div class="ui-header">
            <h1>è´è¶çš„ä¸€ç”Ÿ</h1>
            <div class="stage-indicator" id="stage-text">éšæ®µ 1ï¼šåµ</div>
        </div>

        <!-- å ´æ™¯å€ -->
        <div class="scene">
            <div class="branch" id="branch"></div>
            <div class="leaf" id="leaf"></div>
            
            <!-- ç”Ÿç‰©æœ¬é«” -->
            <div id="creature-container" class="creature egg"></div>

            <!-- è£é£¾ -->
            <div class="flower" style="left: 20%;">ğŸŒ¸</div>
            <div class="flower" style="right: 20%;">ğŸŒ»</div>
        </div>

        <!-- æ–‡å­—èˆ‡äº’å‹•å€ -->
        <div class="instruction-box">
            <div class="instruction-text" id="story-text">
                è‘‰å­ä¸Šæœ‰ä¸€é¡†å°å°çš„åµï¼Œçœ‹èµ·ä¾†å¿«è¦å­µåŒ–äº†ã€‚
            </div>
            <button class="action-btn" id="action-btn" onclick="nextStep()">è¼•è¼•è§¸ç¢°åµ</button>
        </div>
    </div>

    <script>
        // ç‹€æ…‹ç®¡ç†
        let currentStage = 0; // 0: Egg, 1: Larva, 2: Pupa, 3: Adult
        let subStep = 0; // ç”¨æ–¼å¹¼èŸ²åƒè‘‰å­ç­‰ä¸­é–“æ­¥é©Ÿ

        const elements = {
            creature: document.getElementById('creature-container'),
            leaf: document.getElementById('leaf'),
            branch: document.getElementById('branch'),
            stageText: document.getElementById('stage-text'),
            storyText: document.getElementById('story-text'),
            btn: document.getElementById('action-btn')
        };

        // éŠæˆ²é‚è¼¯èˆ‡è³‡æ–™
        const gameData = [
            // Stage 0: Egg
            {
                name: "éšæ®µ 1ï¼šåµ (Egg)",
                setup: () => {
                    elements.creature.className = 'creature egg';
                    elements.creature.innerHTML = ''; // Emoji via CSS
                    elements.leaf.className = 'leaf';
                    elements.leaf.classList.remove('hidden');
                    elements.branch.classList.remove('hidden');
                },
                text: "è‘‰å­èƒŒé¢æœ‰ä¸€é¡†åƒçç ä¸€æ¨£çš„åµã€‚é€™æ˜¯è´è¶ç”Ÿå‘½çš„é–‹å§‹ã€‚",
                btnText: "ç­‰å¾…å­µåŒ–...",
                action: () => {
                    // è½‰å ´åˆ°å¹¼èŸ²
                    transitionToStage(1);
                }
            },
            // Stage 1: Larva (Caterpillar)
            {
                name: "éšæ®µ 2ï¼šå¹¼èŸ² (Larva)",
                setup: () => {
                    elements.creature.className = 'creature caterpillar';
                    elements.creature.innerHTML = '';
                    elements.storyText.innerText = "æ¯›æ¯›èŸ²å­µå‡ºä¾†äº†ï¼å®ƒç¾åœ¨éå¸¸é¤“ã€‚";
                    elements.btn.innerText = "é¤µå®ƒåƒè‘‰å­";
                    subStep = 0;
                },
                action: () => {
                    if (subStep === 0) {
                        // åƒç¬¬ä¸€å£
                        elements.creature.classList.add('eating');
                        elements.leaf.classList.add('eaten');
                        elements.storyText.innerText = "å®ƒæ­£åœ¨å¤§å£å¤§å£åœ°åƒè‘‰å­ï¼Œèº«é«”æ…¢æ…¢è®Šå¤§ã€‚";
                        elements.btn.innerText = "å†åƒå¤šä¸€é»";
                        // è®“æ¯›æ¯›èŸ²è®Šå¤§ä¸€é»
                        elements.creature.style.transform = "scale(1.2)";
                        subStep++;
                    } else if (subStep === 1) {
                        // åƒé£½äº†
                        elements.storyText.innerText = "æ¯›æ¯›èŸ²åƒé£½äº†ï¼Œæº–å‚™å°‹æ‰¾å®‰å…¨çš„åœ°æ–¹çµè›¹ã€‚";
                        elements.btn.innerText = "é–‹å§‹çµè›¹";
                        elements.creature.style.transform = "scale(1.5)";
                        subStep++;
                    } else {
                        // è½‰å ´åˆ°è›¹
                        transitionToStage(2);
                    }
                }
            },
            // Stage 2: Pupa
            {
                name: "éšæ®µ 3ï¼šè›¹ (Pupa)",
                setup: () => {
                    elements.creature.className = 'creature pupa';
                    elements.creature.innerHTML = '<div class="pupa-shape"></div>'; // ä½¿ç”¨ CSS å½¢ç‹€
                    elements.creature.style.transform = "scale(1)"; // é‡ç½®ç¸®æ”¾
                    
                    // è‘‰å­æ¯èæ‰è½æˆ–éš±è—ï¼Œåªå‰©æ¨¹æ
                    elements.leaf.classList.add('withered');
                    setTimeout(() => elements.leaf.classList.add('hidden'), 1000);

                    elements.storyText.innerText = "æ¯›æ¯›èŸ²åçµ²å°‡è‡ªå·±å›ºå®šåœ¨æ¨¹æä¸Šï¼Œè®Šæˆäº†è›¹ã€‚å¤–è¡¨çœ‹èµ·ä¾†éœæ­¢ä¸å‹•ï¼Œä½†é«”å…§æ­£åœ¨ç™¼ç”Ÿç¥å¥‡çš„è®ŠåŒ–ã€‚";
                    elements.btn.innerText = "è§€å¯Ÿè®ŠåŒ–";
                    subStep = 0;
                },
                action: () => {
                    if (subStep === 0) {
                        elements.creature.classList.add('shaking');
                        elements.storyText.innerText = "æ™‚é–“éå»äº†ï¼Œè›¹é–‹å§‹è¼•è¼•æ™ƒå‹•ï¼Œè£¡é¢çš„è´è¶æº–å‚™å¥½äº†ï¼";
                        elements.btn.innerText = "å¹«åŠ©ç¾½åŒ–";
                        subStep++;
                    } else {
                        transitionToStage(3);
                    }
                }
            },
            // Stage 3: Adult
            {
                name: "éšæ®µ 4ï¼šæˆèŸ² (Adult)",
                setup: () => {
                    elements.creature.className = 'creature butterfly';
                    elements.creature.innerHTML = ''; // Emoji via CSS
                    elements.creature.classList.remove('shaking');
                    
                    elements.storyText.innerText = "ç¾éº—çš„è´è¶ç ´è›¹è€Œå‡ºï¼å®ƒçš„ç¿…è†€å±•é–‹äº†ã€‚";
                    elements.btn.innerText = "è®“å®ƒé£›ç¿”";
                    subStep = 0;
                },
                action: () => {
                    if (subStep === 0) {
                        elements.creature.classList.add('flying');
                        elements.storyText.innerText = "è´è¶åœ¨èŠ±å¢ä¸­é£›èˆï¼Œå°‹æ‰¾èŠ±èœœä¸¦æº–å‚™ç”¢åµï¼Œå±•é–‹æ–°çš„ç”Ÿå‘½å¾ªç’°ã€‚";
                        elements.btn.innerText = "é‡æ–°é–‹å§‹";
                        elements.btn.classList.add('restart-btn');
                        subStep++;
                    } else {
                        resetGame();
                    }
                }
            }
        ];

        // æ ¸å¿ƒåŠŸèƒ½ï¼šåŸ·è¡Œç•¶å‰éšæ®µçš„å‹•ä½œ
        function nextStep() {
            gameData[currentStage].action();
        }

        // è½‰å ´åŠŸèƒ½
        function transitionToStage(index) {
            currentStage = index;
            
            // æ›´æ–° UI æ–‡å­—
            elements.stageText.innerText = gameData[index].name;
            elements.storyText.innerText = gameData[index].text || ""; // å¦‚æœæœ‰é è¨­æ–‡å­—
            elements.btn.innerText = gameData[index].btnText || "ç¹¼çºŒ";
            
            // åŸ·è¡Œè©²éšæ®µçš„è¦–è¦ºè¨­å®š
            gameData[index].setup();
        }

        // é‡ç½®éŠæˆ²
        function resetGame() {
            currentStage = 0;
            subStep = 0;
            
            // æ¸…é™¤æ‰€æœ‰é™„åŠ æ¨£å¼
            elements.creature.style.transform = "";
            elements.leaf.classList.remove('eaten', 'withered', 'hidden');
            elements.branch.classList.remove('hidden');
            elements.btn.classList.remove('restart-btn');
            
            // é‡ç½®åˆ°ç¬¬ä¸€éšæ®µ
            gameData[0].setup();
            elements.stageText.innerText = gameData[0].name;
            elements.storyText.innerText = gameData[0].text;
            elements.btn.innerText = gameData[0].btnText;
        }

        // åˆå§‹åŒ–
        window.onload = () => {
            resetGame();
        };

    </script>
</body>
</html>